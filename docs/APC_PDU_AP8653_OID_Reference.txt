================================================================================
APC PDU AP8653 - SNMP OID Reference
================================================================================

Testováno na:
- Model: AP8653
- Rack PDU FW: 7.1.4
- APC OS: 7.1.2

Base OID pro všechny AP8XXX (rPDU2): .1.3.6.1.4.1.318.1.1.26


================================================================================
DEVICE LEVEL (celá PDU)
================================================================================

Base: .1.3.6.1.4.1.318.1.1.26.4.3.1.{sloupec}.1

+--------+------------------------------------------+----------------+----------+
| Suffix | OID                                      | Jednotky SNMP  | Převod   |
+--------+------------------------------------------+----------------+----------+
| .5.1   | .1.3.6.1.4.1.318.1.1.26.4.3.1.5.1       | setiny kW      | ×10 → W  |
|        | rPDU2DeviceStatusPower                   |                |          |
+--------+------------------------------------------+----------------+----------+
| .6.1   | .1.3.6.1.4.1.318.1.1.26.4.3.1.6.1       | setiny kW      | ×10 → W  |
|        | rPDU2DeviceStatusPeakPower               |                |          |
+--------+------------------------------------------+----------------+----------+
| .9.1   | .1.3.6.1.4.1.318.1.1.26.4.3.1.9.1       | desetiny kWh   | ÷10 → kWh|
|        | rPDU2DeviceStatusEnergy                  |                |          |
+--------+------------------------------------------+----------------+----------+

Příklad:
  SNMP vrátí: 52    → Power = 520 W (0.52 kW)
  SNMP vrátí: 26735 → Energy = 2673.5 kWh


================================================================================
OUTLET LEVEL (jednotlivé zásuvky)
================================================================================

Base: .1.3.6.1.4.1.318.1.1.26.9.4.3.1.{sloupec}.{outlet}

+--------+------------------------------------------+----------------+----------+
| Suffix | Popis                                    | Jednotky SNMP  | Převod   |
+--------+------------------------------------------+----------------+----------+
| .3.X   | rPDU2OutletMeteredStatusName             | STRING         | -        |
|        | Název outletu                            |                |          |
+--------+------------------------------------------+----------------+----------+
| .4.X   | rPDU2OutletMeteredStatusIndex            | INTEGER        | -        |
|        | Index outletu                            |                |          |
+--------+------------------------------------------+----------------+----------+
| .6.X   | rPDU2OutletMeteredStatusCurrent          | desetiny A     | ÷10 → A  |
|        | Proud (Ampéry)                           |                |          |
+--------+------------------------------------------+----------------+----------+
| .7.X   | rPDU2OutletMeteredStatusPower            | W              | přímo W  |
|        | Aktuální příkon                          |                |          |
+--------+------------------------------------------+----------------+----------+
| .8.X   | rPDU2OutletMeteredStatusPeakPower        | W              | přímo W  |
|        | Špičkový příkon                          |                |          |
+--------+------------------------------------------+----------------+----------+
| .11.X  | rPDU2OutletMeteredStatusEnergy           | desetiny kWh   | ÷10 → kWh|
|        | Spotřebovaná energie                     |                |          |
+--------+------------------------------------------+----------------+----------+

X = číslo outletu (1-24)

Příklad pro outlet 17:
  .1.3.6.1.4.1.318.1.1.26.9.4.3.1.3.17  → "Arista 1" (název)
  .1.3.6.1.4.1.318.1.1.26.9.4.3.1.6.17  → 4 = 0.4 A
  .1.3.6.1.4.1.318.1.1.26.9.4.3.1.7.17  → 93 W
  .1.3.6.1.4.1.318.1.1.26.9.4.3.1.8.17  → 238 W (peak)
  .1.3.6.1.4.1.318.1.1.26.9.4.3.1.11.17 → 6237 = 623.7 kWh


================================================================================
SNMP PŘÍKAZY
================================================================================

SNMPv1:
  snmpget -v1 -c public <IP> <OID>

SNMPv3 (authPriv):
  snmpget -v3 -l authPriv -u <USER> -a SHA -A <AUTH_PASS> -x AES -X <PRIV_PASS> <IP> <OID>

Příklady:
  # Device power (v1)
  snmpget -v1 -c public 192.168.1.100 .1.3.6.1.4.1.318.1.1.26.4.3.1.5.1

  # Outlet 17 energy (v3)
  snmpget -v3 -l authPriv -u monitor -a SHA -A "MonitorPass123" -x AES -X "PrivacyPass123" \
    192.168.1.100 .1.3.6.1.4.1.318.1.1.26.9.4.3.1.11.17


================================================================================
NETWORK PORT SHARING (NPS) - více PDU na jedné IP
================================================================================

Při propojení PDU přes "In/Out" porty lze číst data z guest PDU přes host.

DEVICE LEVEL:
  Host PDU  (index 1): .1.3.6.1.4.1.318.1.1.26.4.3.1.{sloupec}.1
  Guest PDU (index 2): .1.3.6.1.4.1.318.1.1.26.4.3.1.{sloupec}.2

  Příklad - Power obou PDU:
    .1.3.6.1.4.1.318.1.1.26.4.3.1.5.1  → Host PDU power
    .1.3.6.1.4.1.318.1.1.26.4.3.1.5.2  → Guest PDU power

OUTLET LEVEL:
  Outlety jsou číslovány kontinuálně:
    Host PDU  outlety 1-24  → SNMP index 1-24
    Guest PDU outlety 1-24  → SNMP index 25-48

  Vzorec: SNMP_index = ((PDU_index - 1) × 24) + outlet_number

  Příklad - Outlet 5 na obou PDU:
    .1.3.6.1.4.1.318.1.1.26.9.4.3.1.7.5   → Host PDU, outlet 5
    .1.3.6.1.4.1.318.1.1.26.9.4.3.1.7.29  → Guest PDU, outlet 5 (24+5=29)


================================================================================
POZNÁMKY
================================================================================

- snmpwalk na subtree nemusí fungovat, používejte snmpget na konkrétní OIDy
- Po factory resetu je SNMP community string prázdný - nutno nastavit
- AP8653 má 24 outletů (21× C13 + 3× C19)
- Energy se počítá od posledního resetu (lze resetovat přes SNMP SET)

OID pro reset energy (SNMP SET hodnota 2):
  Device:  .1.3.6.1.4.1.318.1.1.26.4.1.1.11.1  (rPDU2DeviceConfigDeviceEnergyReset)
  Outlets: .1.3.6.1.4.1.318.1.1.26.4.1.1.12.1  (rPDU2DeviceConfigOutletsEnergyReset)

